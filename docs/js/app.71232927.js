(function(e){function t(t){for(var r,o,c=t[0],u=t[1],l=t[2],s=0,d=[];s<c.length;s++)o=c[s],a[o]&&d.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);f&&f(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==a[u]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var f=u;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"2f10":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("canvas",{ref:"main"})])},i=[],o=(n("6b54"),n("f499")),c=n.n(o),u=(n("7f7f"),n("34ef"),n("28a5"),n("5d73")),l=n.n(u),f=n("5176"),s=n.n(f),d=n("795b"),h=n.n(d),p=n("d225"),v=n("b0b4"),b=n("74ce"),m="dosbox",y=function(){function e(t){Object(p["a"])(this,e),this.db=new b["a"](m),this.db.version(1).stores({gameSave:"name"}),this.gameName=t}return Object(v["a"])(e,[{key:"read",value:function(){var e=this;return new h.a(function(t,n){e.db.gameSave.where("name").equals(e.gameName).first().then(function(n){e.gameData=n?n.files:{},t(e.gameData)}).catch(function(e){n(e)})})}},{key:"save",value:function(){var e=this;return new h.a(function(t,n){e.db.gameSave.put({name:e.gameName,files:e.gameData}).then(function(e){t()}).catch(function(e){n()})})}},{key:"clear",value:function(){this.gameData={}}},{key:"add",value:function(e,t){this.gameData[e]=t}},{key:"eachFile",value:function(e){for(var t in this.gameData)e(t,this.gameData[t])}}]),e}(),g={baseUrl:"/static/games/",list:[{name:"pal",title:"仙剑奇侠传一",file:"pal.zip",command:"PAL!.EXE",poster:"",saveFile:/.rpg$/}]},F=function(e,t){return new h.a(function(n,r){Dos(e,{onprogress:function(){},onerror:function(){},log:function(){},wdosboxUrl:"/static/libs/js-dos/wdosbox.js"}).ready(function(e,a){a([]).then(function(a){s()(a,{exec:function(e){var t=this;return new h.a(function(n){t.shellInputClients.push(n);var r=!0,a=!1,i=void 0;try{for(var o,c=l()(e);!(r=(o=c.next()).done);r=!0){var u=o.value;t.shellInputQueue.push(u),t.requestShellInput()}}catch(f){a=!0,i=f}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}})},isDir:function(e){try{return this.api.FS.isDir(this.api.FS.stat(e).mode)}catch(t){return!1}},isFile:function(e){try{return this.api.FS.isFile(this.api.FS.stat(e).mode)}catch(t){return!1}},internalFile:[".","..","dev","home","proc","tmp"],eachFile:function(e,t){t=t||"/";var n=!0,r=!1,a=void 0;try{for(var i,o=l()(this.api.FS.readdir(t));!(n=(i=o.next()).done);n=!0){var c=i.value,u=!1,f=!0,s=!1,d=void 0;try{for(var h,p=l()(this.internalFile);!(f=(h=p.next()).done);f=!0){var v=h.value;v==c&&(u=!0)}}catch(m){s=!0,d=m}finally{try{f||null==p.return||p.return()}finally{if(s)throw d}}if(!u){var b=t+c;this.isFile(b)?e(b):this.isDir(b)&&this.eachFile(e,b+"/")}}}catch(m){r=!0,a=m}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}},writeFile:function(e,t){for(var n=e.split("/"),r="",a=0;a<n.length;a++)n[a]&&(r+="/"+n[a],a==n.length-1?this.api.FS.writeFile(r,t):this.isDir(r)||this.api.FS.mkdir(r))},saveFileToDB:function(){var e=this;this.eachFile(function(n){if(t.saveFile.test(n)){var r=e.api.FS.readFile(n).buffer;e.db.add(n,r)}}),this.db.save()},readFileFromDB:function(){var e=this;this.db.eachFile(function(t,n){e.writeFile(t,new Uint8Array(n))})},exportSaveFile:function(){var e={name:t.name,db:{}};this.db.eachFile(function(t,n){e.db[t]=Array.prototype.slice.call(new Uint8Array(n))});var n=new Blob([c()(e)]),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download=t.name+".json",r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)},importSaveFile:function(e){var n=this,r=document.createElement("input");r.type="file",r.style.display="none",r.addEventListener("change",function(){if("application/json"!=r.files[0].type)e(0);else{var a=new FileReader;a.onload=function(){var r;try{r=JSON.parse(a.result)}catch(d){return void e(0)}if(r.name==t.name){r.db=r.db||{};var i=!0,o=!1,c=void 0;try{for(var u,f=l()(r.db);!(i=(u=f.next()).done);i=!0){var s=u.value;n.db.add(s,new Uint8Array(r.db[s]).buffer)}}catch(h){o=!0,c=h}finally{try{i||null==f.return||f.return()}finally{if(o)throw c}}n.db.save(),n.readFileFromDB()}else e(1)},a.readAsText(r.files[0])}}),document.body.appendChild(r),r.click(),document.body.removeChild(r)}}),e.extract("".concat(g.baseUrl).concat(t.name,"/").concat(t.file)).then(function(){a.exec(["rescan"]).then(function(){a.db=new y(t.name),a.db.read().then(function(){n(a)}).catch(function(e){r("database read error:"+e.toString())})})}).catch(function(e){r("extract file error:"+e.toString())})})})})},w={name:"app",data:function(){return{}},methods:{},mounted:function(){var e=this;this.$nextTick(function(){F(e.$refs.main,g.list[0]).then(function(){})})}},S=w,x=(n("97b3"),n("2877")),j=Object(x["a"])(S,a,i,!1,null,"62f8fdd6",null),D=j.exports;new r["a"]({el:"#app",render:function(e){return e(D)}})},"97b3":function(e,t,n){"use strict";var r=n("2f10"),a=n.n(r);a.a}});
//# sourceMappingURL=app.71232927.js.map